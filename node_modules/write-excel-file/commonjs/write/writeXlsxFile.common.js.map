{"version":3,"sources":["../../source/write/writeXlsxFile.common.js"],"names":["generateSheets","data","sheetNames","schema","columns","headerStyle","fontFamily","fontSize","dateFormat","getSharedStringsXml","getSharedString","getStylesXml","getStyle","worksheets","sheetIndex","sheet","push","customFont","sheets","map","sheetName","i","id","name"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;;;AAEO,SAASA,cAAT,OASJ;AAAA,MARDC,IAQC,QARDA,IAQC;AAAA,MAPDC,UAOC,QAPDA,UAOC;AAAA,MANDC,MAMC,QANDA,MAMC;AAAA,MALDC,OAKC,QALDA,OAKC;AAAA,MAJDC,WAIC,QAJDA,WAIC;AAAA,MAHDC,UAGC,QAHDA,UAGC;AAAA,MAFDC,QAEC,QAFDA,QAEC;AAAA,MADDC,UACC,QADDA,UACC;;AACD,2BAAiD,gCAAjD;AAAA,MAAQC,mBAAR,sBAAQA,mBAAR;AAAA,MAA6BC,eAA7B,sBAA6BA,eAA7B;;AACA,oBAAmC,wBAAW;AAAEJ,IAAAA,UAAU,EAAVA,UAAF;AAAcC,IAAAA,QAAQ,EAARA;AAAd,GAAX,CAAnC;AAAA,MAAQI,YAAR,eAAQA,YAAR;AAAA,MAAsBC,QAAtB,eAAsBA,QAAtB;;AAEA,MAAI,CAACV,UAAL,EAAiB;AACfA,IAAAA,UAAU,GAAG,CAAC,QAAD,CAAb;AACAD,IAAAA,IAAI,GAAG,CAACA,IAAD,CAAP;;AACA,QAAIE,MAAJ,EAAY;AACVA,MAAAA,MAAM,GAAG,CAACA,MAAD,CAAT;AACD;AACF;;AAED,MAAMU,UAAU,GAAG,EAAnB;AACA,MAAIC,UAAU,GAAG,CAAjB;;AACA,uDAAoBZ,UAApB,wCAAgC;AAAA,QAArBa,KAAqB;AAC9BF,IAAAA,UAAU,CAACG,IAAX,CAAgB,2BAAkBf,IAAI,CAACa,UAAD,CAAtB,EAAoC;AAClDX,MAAAA,MAAM,EAAEA,MAAM,IAAIA,MAAM,CAACW,UAAD,CAD0B;AAElDV,MAAAA,OAAO,EAAPA,OAFkD;AAGlDC,MAAAA,WAAW,EAAXA,WAHkD;AAIlDO,MAAAA,QAAQ,EAARA,QAJkD;AAKlDF,MAAAA,eAAe,EAAfA,eALkD;AAMlDO,MAAAA,UAAU,EAAEX,UAAU,IAAIC,QANwB;AAOlDC,MAAAA,UAAU,EAAVA;AAPkD,KAApC,CAAhB;AASAM,IAAAA,UAAU;AACX;;AAED,SAAO;AACLI,IAAAA,MAAM,EAAEhB,UAAU,CAACiB,GAAX,CAAe,UAACC,SAAD,EAAYC,CAAZ;AAAA,aAAmB;AACxCC,QAAAA,EAAE,EAAED,CAAC,GAAG,CADgC;AAExCE,QAAAA,IAAI,EAAEH,SAFkC;AAGxCnB,QAAAA,IAAI,EAAEY,UAAU,CAACQ,CAAD;AAHwB,OAAnB;AAAA,KAAf,CADH;AAMLZ,IAAAA,mBAAmB,EAAnBA,mBANK;AAOLE,IAAAA,YAAY,EAAZA;AAPK,GAAP;AASD","sourcesContent":["import generateWorksheet from './worksheet'\r\nimport initStyles from './styles'\r\nimport initSharedStrings from './sharedStrings'\r\n\r\nexport function generateSheets({\r\n  data,\r\n  sheetNames,\r\n  schema,\r\n  columns,\r\n  headerStyle,\r\n  fontFamily,\r\n  fontSize,\r\n  dateFormat\r\n}) {\r\n  const { getSharedStringsXml, getSharedString } = initSharedStrings()\r\n  const { getStylesXml, getStyle } = initStyles({ fontFamily, fontSize })\r\n\r\n  if (!sheetNames) {\r\n    sheetNames = ['Sheet1']\r\n    data = [data]\r\n    if (schema) {\r\n      schema = [schema]\r\n    }\r\n  }\r\n\r\n  const worksheets = []\r\n  let sheetIndex = 0\r\n  for (const sheet of sheetNames) {\r\n    worksheets.push(generateWorksheet(data[sheetIndex], {\r\n      schema: schema && schema[sheetIndex],\r\n      columns,\r\n      headerStyle,\r\n      getStyle,\r\n      getSharedString,\r\n      customFont: fontFamily || fontSize,\r\n      dateFormat\r\n    }))\r\n    sheetIndex++\r\n  }\r\n\r\n  return {\r\n    sheets: sheetNames.map((sheetName, i) => ({\r\n      id: i + 1,\r\n      name: sheetName,\r\n      data: worksheets[i]\r\n    })),\r\n    getSharedStringsXml,\r\n    getStylesXml\r\n  }\r\n}"],"file":"writeXlsxFile.common.js"}