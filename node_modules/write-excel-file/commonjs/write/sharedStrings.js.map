{"version":3,"sources":["../../source/write/sharedStrings.js"],"names":["initSharedStrings","sharedStrings","sharedStringsIndex","getSharedStringsXml","generateXml","getSharedString","string","id","undefined","String","length","push","xml"],"mappings":";;;;;;;;;;;;;AAAe,SAASA,iBAAT,GAA6B;AAC3C,MAAMC,aAAa,GAAG,EAAtB;AACA,MAAMC,kBAAkB,GAAG,EAA3B;AAEA,SAAO;AACNC,IAAAA,mBADM,iCACgB;AACrB,aAAOC,WAAW,CAACH,aAAD,CAAlB;AACA,KAHK;AAKNI,IAAAA,eALM,2BAKUC,MALV,EAKkB;AACpB,UAAIC,EAAE,GAAGL,kBAAkB,CAACI,MAAD,CAA3B;;AACA,UAAIC,EAAE,KAAKC,SAAX,EAAsB;AACxBD,QAAAA,EAAE,GAAGE,MAAM,CAACR,aAAa,CAACS,MAAf,CAAX;AACAR,QAAAA,kBAAkB,CAACI,MAAD,CAAlB,GAA6BC,EAA7B;AACAN,QAAAA,aAAa,CAACU,IAAd,CAAmBL,MAAnB;AACG;;AACD,aAAOC,EAAP;AACH;AAbK,GAAP;AAeA;;AAED,SAASH,WAAT,CAAqBH,aAArB,EAAoC;AACnC,MAAIW,GAAG,GAAG,uBAAV;AACAA,EAAAA,GAAG,IAAI,yEAAP;;AACA,uDAAqBX,aAArB,wCAAoC;AAAA,QAAzBK,MAAyB;AACnCM,IAAAA,GAAG,qBAAcN,MAAd,cAAH;AACA;;AACDM,EAAAA,GAAG,IAAI,QAAP;AACA,SAAOA,GAAP;AACA","sourcesContent":["export default function initSharedStrings() {\r\n\tconst sharedStrings = []\r\n\tconst sharedStringsIndex = {}\r\n\r\n\treturn {\r\n\t\tgetSharedStringsXml() {\r\n\t\t\treturn generateXml(sharedStrings)\r\n\t\t},\r\n\r\n\t\tgetSharedString(string) {\r\n      let id = sharedStringsIndex[string]\r\n      if (id === undefined) {\r\n\t\t\t\tid = String(sharedStrings.length)\r\n\t\t\t\tsharedStringsIndex[string] = id\r\n\t\t\t\tsharedStrings.push(string)\r\n      }\r\n      return id\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction generateXml(sharedStrings) {\r\n\tlet xml = '<?xml version=\"1.0\"?>'\r\n\txml += '<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">'\r\n\tfor (const string of sharedStrings) {\r\n\t\txml += `<si><t>${string}</t></si>`\r\n\t}\r\n\txml += '</sst>'\r\n\treturn xml\r\n}"],"file":"sharedStrings.js"}