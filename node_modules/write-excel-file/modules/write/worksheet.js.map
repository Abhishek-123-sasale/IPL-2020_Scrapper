{"version":3,"sources":["../../source/write/worksheet.js"],"names":["generateRows","generateColumnsDescription","generateMergedCellsDescription","WORKSHEET_TEMPLATE","generateWorksheet","data","schema","columns","headerStyle","getStyle","getSharedString","customFont","dateFormat","Array","isArray","TypeError","length","replace"],"mappings":"AAAA;AACA;AACA;AAEA,OAAOA,YAAP,MAAyB,QAAzB;AACA,OAAOC,0BAAP,MAAuC,WAAvC;AACA,OAAOC,8BAAP,MAA2C,kCAA3C,C,CAEA;AACA;;AAEA,IAAMC,kBAAkB,yqBAAxB;AAGA,eAAe,SAASC,iBAAT,CAA2BC,IAA3B,QAQZ;AAAA,MAPFC,MAOE,QAPFA,MAOE;AAAA,MANFC,OAME,QANFA,OAME;AAAA,MALFC,WAKE,QALFA,WAKE;AAAA,MAJFC,QAIE,QAJFA,QAIE;AAAA,MAHFC,eAGE,QAHFA,eAGE;AAAA,MAFFC,UAEE,QAFFA,UAEE;AAAA,MADFC,UACE,QADFA,UACE;;AACF,MAAIN,MAAJ,EAAY;AACX,QAAI,CAACO,KAAK,CAACC,OAAN,CAAcT,IAAd,CAAL,EAA0B;AACzB,YAAM,IAAIU,SAAJ,CAAc,8BAAd,CAAN;AACA;AACD,GAJD,MAIO;AACN,QAAI,CAACF,KAAK,CAACC,OAAN,CAAcT,IAAd,CAAL,EAA0B;AACzB,YAAM,IAAIU,SAAJ,CAAc,6BAAd,CAAN;AACA;;AACD,QAAIV,IAAI,CAACW,MAAL,GAAc,CAAlB,EAAqB;AACpB,UAAI,CAACH,KAAK,CAACC,OAAN,CAAcT,IAAI,CAAC,CAAD,CAAlB,CAAL,EAA6B;AAC5B,cAAM,IAAIU,SAAJ,CAAc,6BAAd,CAAN;AACA;AACD;AACD;;AAEA,SAAOZ,kBAAkB,CACvBc,OADK,CACG,QADH,EACajB,YAAY,CAACK,IAAD,EAAO;AACrCC,IAAAA,MAAM,EAANA,MADqC;AAErCE,IAAAA,WAAW,EAAXA,WAFqC;AAGrCC,IAAAA,QAAQ,EAARA,QAHqC;AAIrCC,IAAAA,eAAe,EAAfA,eAJqC;AAKrCC,IAAAA,UAAU,EAAVA,UALqC;AAMrCC,IAAAA,UAAU,EAAVA;AANqC,GAAP,CADzB,EASLK,OATK,CASG,sBATH,EAS2BhB,0BAA0B,CAAC;AAAEK,IAAAA,MAAM,EAANA,MAAF;AAAUC,IAAAA,OAAO,EAAPA;AAAV,GAAD,CATrD,EAULU,OAVK,CAUG,0BAVH,EAU+Bf,8BAA8B,CAACG,IAAD,EAAO;AAAEC,IAAAA,MAAM,EAANA;AAAF,GAAP,CAV7D,CAAP;AAWD","sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/zipcelx.js\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/templates/worksheet.xml.js\r\n\r\nimport generateRows from './rows'\r\nimport generateColumnsDescription from './columns'\r\nimport generateMergedCellsDescription from './generateMergedCellsDescription'\r\n\r\n// const WORKSHEET_TEMPLATE = `<?xml version=\"1.0\" ?>\r\n// <worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:mv=\"urn:schemas-microsoft-com:mac:vml\" xmlns:mx=\"http://schemas.microsoft.com/office/mac/excel/2008/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\" xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\"><sheetData>{data}</sheetData></worksheet>`;\r\n\r\nconst WORKSHEET_TEMPLATE = `<?xml version=\"1.0\" ?>\r\n<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:mv=\"urn:schemas-microsoft-com:mac:vml\" xmlns:mx=\"http://schemas.microsoft.com/office/mac/excel/2008/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\" xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\">{columnsDescription}<sheetData>{data}</sheetData>{mergedCellsDescription}</worksheet>`;\r\n\r\nexport default function generateWorksheet(data, {\r\n\tschema,\r\n\tcolumns,\r\n\theaderStyle,\r\n\tgetStyle,\r\n\tgetSharedString,\r\n\tcustomFont,\r\n\tdateFormat\r\n}) {\r\n\tif (schema) {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError('Expected an array of objects')\r\n\t\t}\r\n\t} else {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError('Expected an array of arrays')\r\n\t\t}\r\n\t\tif (data.length > 0) {\r\n\t\t\tif (!Array.isArray(data[0])) {\r\n\t\t\t\tthrow new TypeError('Expected an array of arrays')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n  return WORKSHEET_TEMPLATE\r\n  \t.replace('{data}', generateRows(data, {\r\n  \t\tschema,\r\n  \t\theaderStyle,\r\n  \t\tgetStyle,\r\n  \t\tgetSharedString,\r\n  \t\tcustomFont,\r\n  \t\tdateFormat\r\n  \t}))\r\n  \t.replace('{columnsDescription}', generateColumnsDescription({ schema, columns }))\r\n  \t.replace('{mergedCellsDescription}', generateMergedCellsDescription(data, { schema }))\r\n}"],"file":"worksheet.js"}